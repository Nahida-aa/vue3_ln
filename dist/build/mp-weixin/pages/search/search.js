"use strict";const e=require("../../common/vendor.js"),a=require("../../api/apis.js"),o=require("../../config/index.js");if(!Array){(e.resolveComponent("uni-search-bar")+e.resolveComponent("uni-icons")+e.resolveComponent("uv-empty")+e.resolveComponent("uni-load-more"))()}Math||((()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-search-bar/uni-search-bar.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-icons/uni-icons.js")+(()=>"../../node-modules/@climblee/uv-ui/components/uv-empty/uv-empty.js")+(()=>"../../node-modules/@dcloudio/uni-ui/lib/uni-load-more/uni-load-more.js"))();const l={__name:"search",setup(l){const u=e.ref({page:1,page_size:12,keyword:""}),n=e.ref(e.index.getStorageSync("historySearch")||[]),i=e.ref(["美女","帅哥","宠物","卡通"]),r=e.ref(!1),t=e.ref(!1),s=e.ref([]),v=()=>{if(!u.value.keyword.trim())return;const a=u.value.keyword.trim();e.index.showLoading(),n.value=[...new Set([a,...n.value])].slice(0,10),e.index.setStorageSync("historySearch",n.value),h(),m()},d=()=>{h()},c=e=>{h(),u.value.keyword=e,v()},p=()=>{e.index.showModal({title:"是否清空历史搜索？",success:a=>{a.confirm&&(e.index.removeStorageSync("historySearch"),n.value=[])}})},m=async()=>{try{let l=await a.apiSearch(u.value);o.is_dev,s.value=[...s.value,...l.data],l.next||(r.value=!0),0==l.count&&(t.value=!0),e.index.setStorageSync("storeWallList",s.value),o.is_dev}finally{e.index.hideLoading()}},h=()=>{u.value.page=1,s.value=[],r.value=!1,t.value=!1};return e.onReachBottom((()=>{r.value||(u.value.page++,m())})),e.onUnload((()=>{})),(a,o)=>e.e({a:e.o(v),b:e.o(d),c:e.o(d),d:e.o((e=>u.value.keyword=e)),e:e.p({focus:!0,placeholder:"搜索",modelValue:u.value.keyword}),f:!s.value.length||t.value},!s.value.length||t.value?e.e({g:n.value.length},n.value.length?{h:e.p({type:"trash",size:"25"}),i:e.o(p),j:e.f(n.value,((a,o,l)=>({a:e.t(a),b:a,c:e.o((e=>c(a)),a)})))}:{},{k:e.f(i.value,((a,o,l)=>({a:e.t(a),b:a,c:e.o((e=>c(a)),a)})))}):{},{l:t.value},t.value?{m:e.p({mode:"search",icon:"http://cdn.uviewui.com/uview/empty/search.png"})}:e.e({n:e.f(s.value,((e,a,o)=>({a:e.small_url,b:`/pages/preview/preview?id=${e._id}`,c:e._id}))),o:r.value||s.value.length},r.value||s.value.length?{p:e.p({status:r.value?"noMore":"loading"})}:{}))}},u=e._export_sfc(l,[["__scopeId","data-v-758ecf9e"]]);wx.createPage(u);
